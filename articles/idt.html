<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>x64mayhem | Instruction Rewriting.</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
<link rel="stylesheet" href="./tstyle.css">

</head>
<body>
<!-- partial:index.partial.html -->
<head>
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>

  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>

<header>
<h1>Thought : Can't blindly trust automatic decompilers</h1>
</header>
  
<section class="container">
  <p><strong>Ghidra is powerfull but sometimes it can misdirect a noob like me.</strong></p>
<h3>What happened and why am I crying this much about this?
</h3>
<br>
<p>
So I was doing this crack me challenge, it was pretty easy - of course now I know, but still, it would have been much easier if I have used our go-to for any reversing IDA. But me being me, decided that I should use Ghidra. I have just started to use this tool and honestly, I love the part where it spits C like pseudocode out of those assembly chunks, so I thought: "Okay, as this is relatively easy challenge (as marked on the website), we can just see what it does by pseudo C code in Ghidra and get done with it."
</p>

<p>
  And I started with the usual thing, check the file type and section alignments blah blah... then with lots of hope fired up Ghidra and activated that dragon face (you know if you know), started going through all of it, cleaning up code and defining reasonable variables and then this : 
</p>
<img src="./img/idt1.png">
<img src="./img/idt0.png">
<img src="./img/idta.png">



<p>
  Now WTF (what the fluctuation) is this? why we are trying to append or add <strong>'\n'</strong> to our string and even if we are doing it... how I am supposed to pass that from <strong>gets()</strong>? it will terminate the string at the first escape sequence!
  <br>
  I was actually not able to understand what it is trying to do, plus the assembly view also showed the same thing. So no help.

</p>
<h3>How I solved it then?</h3>
<p>
<br>
Good question. So after about 30 mins. It struck my small 15g brain that '\n' is actually equivalent to <strong>0xA</strong> (when I was learning x86 assembly, we used this to create newline in std::out).
<br>
And you know what? 0xA in hexa = 10 decimal and yeah ... it was supposed to be easy... it was just adding 10 to our input and then comparing with the string hardcoded.
So I just made a python script to reverse this. subtract 10 from the hardcoded string <br> <strong>youdidit</strong> = <strong>oekZ_Z_j</strong>
<br>
</p>
<img src="./img/idt3.png">
<img src="./img/idt4.png">

<br>
<p>
  And of course it worked. Ghidra just converted every hex to its ascii equivalent. I know this was minor and it was me being dumb, but hey! it doesn't hit you when you are doing it sometimes.
  And I accept the fact that the title might be overkill for this, but okay.
  
</p>

<p><a href="../blog.html">--Back to Home </a></p>
</section>
<!-- partial -->
  <script  src="./script.js"></script>
<br>
</body>
</html>
